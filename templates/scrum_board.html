<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://kit.fontawesome.com/4b4c250273.js" crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <!--CSS-->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sprint.css') }}">
    
</head>
<body>

    <h1>
        <!-- Sprints with icons -->
        <div class="sprint-name-icon">
            <i class="fa-solid fa-bars icon" style="margin-right: 120px;"></i>
            <i class="fa-solid fa-database" style="margin-right: 20px;"></i>Sprints
        </div>
    
        <div class="new-label-container">
        <div class="new-button" onclick="showDialog()">New</div>

        </div>
    </h1>

    <form action="/newSprint" method="POST">
        <!-- Pop-up dialog content -->
        <div id="new-dialog" class="pop-up-dialog">
            <i class="fa-regular fa-circle-xmark" onclick="closeDialog()" ></i>
            <h2 class="dialog-heading">Add New Sprint</h2>
            <hr class="dialog-line"> 
            <div class="form-field">
                <label for="sprint-name">Sprint Name:</label>
                <input type="text" id="sprint-name" name="sprint-name" required>
            </div>
            <div class="form-field">
                <div class="date-inputs">
                    <label for="sprint-date">Sprint Start Date:</label>
                    <input type="date" name="sprint-start-date" class="date-input" placeholder="Select Date Range" required>
                </div>
            </div>
            <div class="form-field">
                <div class="date-inputs">
                    <label for="sprint-date">Sprint End Date:</label>
                    <input type="date" name="sprint-end-date" class="date-input" placeholder="Select Date Range" required>
                </div>
            </div>
                        
            <div class="form-field">
                <!--Drop-down list of task status-->
                <label for="status" class="addTaskLabel"> Status</label><br>
                <select name="sprint-status" onchange="changeColor(this)" class="addTaskSelectLeft" disabled>
                    <option value="">Select an option</option>
                    <option value="Not Started" selected>Not Started</option>
                    <option value="Incomplete">In Progress</option>
                    <option value="Completed">Completed</option>
                </select><br><br>
            </div>
            
            
            <div class="button-container">
                <input type="submit" value="Save" class="button">
                <!-- <button class="button" onclick="createSprint()">Create</button> -->
                <button class="button" onclick="closeDialog()">Cancel</button>
            </div>
        </div>
    </form>


    <table>
        <thead>
            <tr>
                <!-- Sprint Name with icon -->
                <th>
                    <i class="fa-solid fa-a" style="margin-right: 20px;"></i>
                    Sprint Name
                </th>
                <!-- Sprint Status with icon -->
                <th>
                    <i class="fa-solid fa-spinner"></i>
                    Sprint Status
                </th>
                <!-- Sprint Date with icon -->
                <th>
                    <i class="fa-solid fa-calendar-days"></i>
                    Date
                </th>
            </tr>
        </thead>

        <tbody>
            {% for sprint in sprints %}
                <tr>
                    <td><i class="material-icons" style="margin-right: 5%;">directions_run</i>{{ sprint.sprint_name }}
                        <button onclick="navigateToSprint(sprint.id)">View Details</button>
                        </td>
                    <td>
                        <!-- to update class for containing sprint status like task label in product backlog -->
                        <div class="">{{sprint.sprint_status}}</div>
                    </td>
                    <td>{{ sprint.sprint_start_date }} &#8594 {{ sprint.sprint_end_date }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>


    <script>
        
        
        function showDialog() {
            document.getElementById("new-dialog").style.display = "block";
        }

        function closeDialog() {
            document.getElementById("new-dialog").style.display = "none";
        }

        function createSprint() {
            // Logic to create a new sprint here
            closeDialog(); // Close the dialog after creating
        }

        $(function() {
            // Initialize the date-range picker
            $('#sprint-date').daterangepicker({
                autoUpdateInput: false,
                locale: {
                    cancelLabel: 'Clear'
                }
            });

            // Handle date range selection
            $('#sprint-date').on('apply.daterangepicker', function(ev, picker) {
                $(this).val(picker.startDate.format('YYYY/MM/DD') + ' - ' + picker.endDate.format('YYYY/MM/DD'));
            });

            // Handle clearing the date range
            $('#sprint-date').on('cancel.daterangepicker', function(ev, picker) {
                $(this).val('');
            });
        });
    </script>
</body>
</html>
